{"version":3,"file":"fetch-product-variant.js","sourceRoot":"","sources":["../../../../src/cli/utilities/extensions/fetch-product-variant.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,uBAAuB,EAA2B,MAAM,qCAAqC,CAAA;AACrG,OAAO,EAAC,YAAY,EAAC,MAAM,iCAAiC,CAAA;AAC5D,OAAO,EAAC,wBAAwB,EAAC,MAAM,+BAA+B,CAAA;AACtE,OAAO,EAAC,UAAU,EAAC,MAAM,6BAA6B,CAAA;AAEtD;;;;GAIG;AACH,MAAM,CAAC,KAAK,UAAU,mBAAmB,CAAC,KAAa;IACrD,MAAM,YAAY,GAAG,MAAM,wBAAwB,CAAC,KAAK,CAAC,CAAA;IAC1D,MAAM,MAAM,GAA6B,MAAM,YAAY,CAAC,uBAAuB,EAAE,YAAY,CAAC,CAAA;IAClG,MAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAA;IACtC,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC;QACvB,MAAM,IAAI,UAAU,CAClB,kCAAkC,EAClC;0CACoC,KAAK,qBAAqB,CAC/D,CAAA;IACH,MAAM,UAAU,GAAG,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAE,CAAC,IAAI,CAAC,EAAE,CAAA;IAC5E,MAAM,SAAS,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAA;IAC7C,OAAO,SAAS,CAAA;AAClB,CAAC","sourcesContent":["import {FindProductVariantQuery, FindProductVariantSchema} from '../../api/graphql/get_variant_id.js'\nimport {adminRequest} from '@shopify/cli-kit/node/api/admin'\nimport {ensureAuthenticatedAdmin} from '@shopify/cli-kit/node/session'\nimport {AbortError} from '@shopify/cli-kit/node/error'\n\n/**\n * Retrieve the first variant of the first product of the given store\n * @param store - Store FQDN\n * @returns variantID if exists\n */\nexport async function fetchProductVariant(store: string) {\n  const adminSession = await ensureAuthenticatedAdmin(store)\n  const result: FindProductVariantSchema = await adminRequest(FindProductVariantQuery, adminSession)\n  const products = result.products.edges\n  if (products.length === 0)\n    throw new AbortError(\n      'Could not find a product variant',\n      `Your store needs to have at least one product to test a 'checkout_ui' extension\\n\nYou can add a new product here: https://${store}/admin/products/new`,\n    )\n  const variantURL = result.products.edges[0]!.node.variants.edges[0]!.node.id\n  const variantId = variantURL.split('/').pop()\n  return variantId\n}\n"]}