{"version":3,"file":"theme-extension-config.js","sourceRoot":"","sources":["../../../../src/cli/services/deploy/theme-extension-config.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,mBAAmB,EAAC,MAAM,qCAAqC,CAAA;AACvE,OAAO,EAAC,QAAQ,EAAC,MAAM,0BAA0B,CAAA;AACjD,OAAO,EAAC,YAAY,EAAE,OAAO,EAAC,MAAM,4BAA4B,CAAA;AAQhE,MAAM,CAAC,KAAK,UAAU,oBAAoB,CAAC,cAA8B;IACvE,MAAM,KAAK,GAA4B,EAAE,CAAA;IACzC,MAAM,UAAU,GAAG,MAAM,mBAAmB,CAAC,cAAc,CAAC,CAAA;IAC5D,MAAM,OAAO,CAAC,GAAG,CACf,UAAU,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE;QAChC,MAAM,gBAAgB,GAAG,YAAY,CAAC,cAAc,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAA;QACzE,MAAM,aAAa,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAA;QAC/C,MAAM,QAAQ,GAAG,aAAa,KAAK,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAA;QAC/D,MAAM,YAAY,GAAG,MAAM,QAAQ,CAAC,QAAQ,EAAE,EAAC,QAAQ,EAAC,CAAC,CAAA;QACzD,KAAK,CAAC,gBAAgB,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IAClF,CAAC,CAAC,CACH,CAAA;IACD,OAAO,EAAC,eAAe,EAAE,EAAC,KAAK,EAAC,EAAC,CAAA;AACnC,CAAC","sourcesContent":["import {ThemeExtension} from '../../models/app/extensions.js'\nimport {themeExtensionFiles} from '../../utilities/extensions/theme.js'\nimport {readFile} from '@shopify/cli-kit/node/fs'\nimport {relativePath, dirname} from '@shopify/cli-kit/node/path'\n\nexport interface ThemeExtensionConfig {\n  theme_extension: {\n    files: {[key: string]: string}\n  }\n}\n\nexport async function themeExtensionConfig(themeExtension: ThemeExtension): Promise<ThemeExtensionConfig> {\n  const files: {[key: string]: string} = {}\n  const themeFiles = await themeExtensionFiles(themeExtension)\n  await Promise.all(\n    themeFiles.map(async (filepath) => {\n      const relativePathName = relativePath(themeExtension.directory, filepath)\n      const directoryName = dirname(relativePathName)\n      const encoding = directoryName === 'assets' ? 'binary' : 'utf8'\n      const fileContents = await readFile(filepath, {encoding})\n      files[relativePathName] = Buffer.from(fileContents, encoding).toString('base64')\n    }),\n  )\n  return {theme_extension: {files}}\n}\n"]}