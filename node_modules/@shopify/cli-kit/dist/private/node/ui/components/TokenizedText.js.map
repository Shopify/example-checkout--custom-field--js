{"version":3,"file":"TokenizedText.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/components/TokenizedText.tsx"],"names":[],"mappings":"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","sourcesContent":["import {Command} from './Command.js'\nimport {Link} from './Link.js'\nimport {List} from './List.js'\nimport {UserInput} from './UserInput.js'\nimport {FilePath} from './FilePath.js'\nimport {Subdued} from './Subdued.js'\nimport {Box, Text} from 'ink'\nimport React, {FunctionComponent} from 'react'\n\nexport interface CommandToken {\n  command: string\n}\n\nexport interface LinkToken {\n  link: {\n    label?: string\n    url: string\n  }\n}\n\nexport interface CharToken {\n  char: string\n}\n\nexport interface UserInputToken {\n  userInput: string\n}\n\nexport interface SubduedToken {\n  subdued: string\n}\n\nexport interface FilePathToken {\n  filePath: string\n}\n\nexport interface ListToken {\n  list: {\n    title?: string\n    items: TokenItem<InlineToken>[]\n    ordered?: boolean\n  }\n}\n\nexport interface BoldToken {\n  bold: string\n}\n\nexport type Token =\n  | string\n  | CommandToken\n  | LinkToken\n  | CharToken\n  | UserInputToken\n  | SubduedToken\n  | FilePathToken\n  | ListToken\n  | BoldToken\n\nexport type InlineToken = Exclude<Token, ListToken>\nexport type TokenItem<T extends Token = Token> = T | T[]\n\ntype DisplayType = 'block' | 'inline'\ninterface Block {\n  display: DisplayType\n  value: Token\n}\n\nfunction tokenToBlock(token: Token): Block {\n  return {\n    display: typeof token !== 'string' && 'list' in token ? 'block' : 'inline',\n    value: token,\n  }\n}\n\nexport function tokenItemToString(token: TokenItem): string {\n  if (typeof token === 'string') {\n    return token\n  } else if ('command' in token) {\n    return token.command\n  } else if ('link' in token) {\n    return token.link.label || token.link.url\n  } else if ('char' in token) {\n    return token.char\n  } else if ('userInput' in token) {\n    return token.userInput\n  } else if ('subdued' in token) {\n    return token.subdued\n  } else if ('filePath' in token) {\n    return token.filePath\n  } else if ('list' in token) {\n    return token.list.items.map(tokenItemToString).join(' ')\n  } else if ('bold' in token) {\n    return token.bold\n  } else {\n    return token\n      .map((item, index) => {\n        if (index !== 0 && !(typeof item !== 'string' && 'char' in item)) {\n          return ` ${tokenItemToString(item)}`\n        } else {\n          return tokenItemToString(item)\n        }\n      })\n      .join('')\n  }\n}\n\nexport function appendToTokenItem(token: TokenItem, suffix: string): TokenItem {\n  return Array.isArray(token) ? [...token, {char: suffix}] : [token, {char: suffix}]\n}\n\nfunction splitByDisplayType(acc: Block[][], item: Block) {\n  if (item.display === 'block') {\n    acc.push([item])\n  } else {\n    const last = acc[acc.length - 1]\n    if (last && last[0]!.display === 'inline') {\n      last.push(item)\n    } else {\n      acc.push([item])\n    }\n  }\n  return acc\n}\n\nconst InlineBlocks: React.FC<{blocks: Block[]}> = ({blocks}) => {\n  return (\n    <Text>\n      {blocks.map((block, blockIndex) => (\n        <Text key={blockIndex}>\n          {blockIndex !== 0 && !(typeof block.value !== 'string' && 'char' in block.value) && <Text> </Text>}\n          <TokenizedText item={block.value} />\n        </Text>\n      ))}\n    </Text>\n  )\n}\n\ninterface TokenizedTextProps {\n  item: TokenItem\n}\n\n/**\n * `TokenizedText` renders a text string with tokens that can be either strings,\n * links, and commands.\n */\nconst TokenizedText: FunctionComponent<TokenizedTextProps> = ({item}) => {\n  if (typeof item === 'string') {\n    return <Text>{item}</Text>\n  } else if ('command' in item) {\n    return <Command command={item.command} />\n  } else if ('link' in item) {\n    return <Link {...item.link} />\n  } else if ('char' in item) {\n    return <Text>{item.char[0]}</Text>\n  } else if ('userInput' in item) {\n    return <UserInput userInput={item.userInput} />\n  } else if ('subdued' in item) {\n    return <Subdued subdued={item.subdued} />\n  } else if ('filePath' in item) {\n    return <FilePath filePath={item.filePath} />\n  } else if ('list' in item) {\n    return <List {...item.list} />\n  } else if ('bold' in item) {\n    return <Text bold>{item.bold}</Text>\n  } else {\n    const groupedItems = item.map(tokenToBlock).reduce(splitByDisplayType, [])\n\n    return groupedItems.length === 1 && groupedItems[0]!.every((item) => item.display === 'inline') ? (\n      <InlineBlocks blocks={groupedItems[0]!} />\n    ) : (\n      <Box flexDirection=\"column\">\n        {groupedItems.map((items, groupIndex) => {\n          if (items[0]!.display === 'inline') {\n            return <InlineBlocks blocks={items} key={groupIndex} />\n          } else {\n            return <List key={groupIndex} {...(items[0]!.value as ListToken).list} />\n          }\n        })}\n      </Box>\n    )\n  }\n}\n\nexport {TokenizedText}\n"]}